USE IQTools_KeHMIS
GO
ALTER TABLE tmp_PatientMaster ADD Id INT IDENTITY(1,1)
GO 

/*
select * from tmp_PatientMaster WHERE PatientPK IN (
	116, 130, 335, 270, 245, 660, 703, 751, 1010, 1144, 1252, 1316, 1257, 1318, 1581, 1613, 1455, 1701, 1837, 1851, 1810, 1908, 2235, 2070, 2248, 2326, 2332, 2421, 2511, 2433, 2353, 2646, 2659, 2818, 2912, 3110, 3121, 3132, 3084, 2991, 3057, 3237, 3186, 3304, 3306, 3300, 3303, 3545, 3455, 3424, 3622, 3747, 3749, 3692, 3797, 4034, 4059, 3981, 4048, 3906, 3933, 4157, 4246, 4338, 4268, 4438, 4391, 4644, 4579, 4565, 4656, 4530, 4575, 4477, 4512, 4725, 4671, 4734, 4714, 4802, 4782, 4934, 4888, 4991, 4833, 4868, 5012, 4927, 4926, 4886, 4860, 5214, 5185, 5111, 5156, 5057, 5223, 5252, 5276, 5274, 5399, 5428, 5348, 5347, 5530, 5598, 5475, 5712, 5759, 5734, 5846, 5805, 5802, 5881, 5933, 6071, 5958, 5928, 5993, 6126, 6222, 6279, 6323, 6295, 6450, 6394, 6480, 6427, 6445, 6513, 6418, 6680, 6807, 6814, 7020, 6903, 6923, 6950, 7050, 6949, 7071, 7097, 7180, 7093, 7217, 7211, 7140, 7094, 7461, 7486, 7392, 7353, 7376, 7651, 7641, 7743, 7840, 8029, 8012, 8275, 8258, 8112, 9365, 9488, 9377, 9596, 9523, 10020, 9965, 10212, 10192, 10220, 10186, 10185, 10210, 10213, 10115, 10217, 10205, 10189, 10090, 10255, 10245, 10268, 10301, 10313, 10230, 10295, 10289, 10305, 10274, 10280, 10318, 10413, 10411, 10358, 10371, 10422, 10347, 10360, 10379, 10424, 10351, 10339, 10448, 10438, 11133, 11542, 11418, 11125, 11535, 11395, 11124, 11453, 11557, 10586, 10890, 11135, 11492, 11412, 11531, 11540, 11599, 11578, 11568, 11589, 11594, 11632, 11817, 11962, 12011, 12505, 12015, 12029, 12549, 12376, 12072, 12094, 12292, 13221
)
*/

DELETE FROM tmp_PatientMaster WHERE ID IN (
	SELECT ID FROM (		
			SELECT ROW_NUMBER() OVER(Partition by PatientPk ORDeR BY PatientPk desc) as RowNum, * FROM tmp_PatientMaster 
	) r WHERE r.RowNum > 1
)

ALTER TABLE mst_patient_decoded ADD Id INT IDENTITY(1,1)
GO 

DELETE FROM mst_patient_decoded WHERE ID IN (
	SELECT ID FROM (		
			SELECT ROW_NUMBER() OVER(Partition by Ptn_pk ORDeR BY Ptn_Pk desc) as RowNum, * FROM mst_patient_decoded 
	) r WHERE r.RowNum > 1
)

ALTER TABLE tmp_ARTPatients ADD Id INT IDENTITY(1,1)
GO 

DELETE FROM tmp_ARTPatients WHERE ID IN (
	SELECT ID FROM (		
			SELECT ROW_NUMBER() OVER(Partition by PatientPk ORDeR BY PatientPk desc) as RowNum, * FROM tmp_ARTPatients 
	) r WHERE r.RowNum > 1
)


/*
UPDATE mst_patient SET DeleteFlag = 1 WHERE PatientEnrollmentID is NOT null AND DeleteFlag = 0 AND Ptn_Pk NOT IN (
	select p.ptn_pk from patient p WHERE DeleteFlag = 0
) */



 